<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>VK API</title>
    <script src="https://vk.com/js/api/openapi.js?169" type="text/javascript"></script>
  </head>
  <body>
    <button type="button" class="sign">Sign In</button>
    <h1>СМЕШНЫЕ КАРТИНКИ =)</h1>
<img src="" alt="photo" class="result">
<button type="button" class="next">Next</button>
<button type="button" class="save">Save</button>
<script type="text/javascript">
function auth(){

}
  const image = document.querySelector(".result");
  const sign = document.querySelector(".sign")
  const next = document.querySelector(".next")
  const save = document.querySelector(".save")
  const owner = 514918087;
  first_id = 457239127;
// url = "https://api.vk.com/method/photos.getById?photos=514918087_457239435&access_token=194e5aa7194e5aa7194e5aa7c819332b691194e194e5aa77b9a1f6e0505b26b23ec71f8&v=5.131";
  VK.init({
    apiId: 8221134
  });
  sign.addEventListener("click", () => {
    VK.Auth.login({scope:"photos"},function(response) {
    if (response.status=="connected") {
      alert("Крутяк =)");
    }
    });
  });
next.addEventListener("click", () => {
  id = first_id+Math.floor(Math.random() * 300);
  VK.Api.call('photos.getById', {photos:owner+'_'+id,v:'5.131'}, function(data) {
    if(!data.error) {
      let height = 0;
      let num = 0;
      size = data.response[0]['sizes'];
    for (let i = 0; i < size.length; i++) {
      if(size[i]['height']>height){
        height= size[i]['height'];
        num = i;
      }
    }
    image.src = size[num]['url'];
  }
  else{
    console.log(data.error);
  }
});
});
save.addEventListener("click", () => {
  VK.Api.call('photos.copy', {owner_id:owner,photo_id:id,v:'5.131'}, function(data) {
    console.log(data);
});
});
</script>
  </body>
</html>
